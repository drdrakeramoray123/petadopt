<!DOCTYPE html>
<html lang="en">
    <head>
        <%- include("../includes/head") %> <%- include("../includes/navbar") %>
        <title>Messages</title>
    </head>
    <body class="bg-slate-200">
        <div class="container mx-auto px-4 pt-8">
            <div class="flex flex-wrap">
                <!-- Sidebar -->
                <section class="w-full md:w-1/6 lg:w-1/4 p-4">
                    <%- include("../includes/sidebar") %>
                </section>
                <!-- End Sidebar -->

                <!-- Main -->
                <section class="w-full md:w-5/6 lg:w-3/4 p-4">
                    <div
                        class="bg-white border-transparent h-full rounded-lg shadow-lg"
                    >
                        <div
                            class="bg-blue-700 border-b-2 border-blue-400 rounded-tl-lg rounded-tr-lg p-2"
                        >
                            <h5 class="font-bold uppercase text-white">
                                Inbox
                            </h5>
                        </div>
                        <div class="p-6">
                            <div class="flex flex-wrap -mx-3 mb-6">
                                <% if(!messages) { %>
                                <div class="w-full px-3">
                                    <p class="text-center text-gray-600">
                                        No messages yet.
                                    </p>
                                </div>
                                <% } else { for(let message of messages) { %> %>
                                <a
                                    href="/message/<%= message._id %>"
                                    class="w-full md:w-1/2 lg:w-1/3"
                                >
                                    <div
                                        class="m-2 p-2 bg-blue-500 hover:bg-blue-700 lg:min-h-max text-white shadow-lg rounded-md"
                                    >
                                        <div class="flex items-center">
                                            <div class="py-1">
                                                <h3 class="text-lg font-bold">
                                                    <%- message.name %>
                                                </h3>
                                                <p
                                                    class="text-sm text-gray-200"
                                                >
                                                    <%= message.message.length >
                                                    150 ?
                                                    message.message.substring(0,
                                                    150) + "..." :
                                                    message.message %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                                <% } } %>
                            </div>
                        </div>
                        <% currentPage == null ? currentPage = 1 : currentPage
                        %> <% if(pages > 1) { %>
                        <div class="my-2 flex justify-center">
                            <% for (let i = 1; i <= pages; i++) { %>
                            <a
                                href="?page=<%= i %>"
                                class="m-2 px-4 py-2 rounded-md outline-none <%= (currentPage == i) ? 'bg-indigo-600 text-white' : 'border-2 border-transparent hover:border-indigo-400 hover:text-indigo-400' %>"
                            >
                                <%= i %>
                            </a>
                            <% } %>
                        </div>
                        <% } %>
                    </div>
                </section>
                <!-- End Main -->
            </div>
        </div>
        <%- include("../includes/footer") %>
    </body>
</html>
